!function t(a,e,i){function n(o,r){if(!e[o]){if(!a[o]){var s="function"==typeof require&&require;if(!r&&s)return s(o,!0);if(l)return l(o,!0);var d=new Error("Cannot find module '"+o+"'");throw d.code="MODULE_NOT_FOUND",d}var c=e[o]={exports:{}};a[o][0].call(c.exports,function(t){var e=a[o][1][t];return n(e||t)},c,c.exports,t,a,e,i)}return e[o].exports}for(var l="function"==typeof require&&require,o=0;o<i.length;o++)n(i[o]);return n}({1:[function(t,a,e){"use strict";function i(){var t=$("input[name=companyName]").val().trim();layui.table.reload("compnayList",{where:{company:t},page:{curr:1}})}function n(){layui.use(["table"],function(){var t=layui.table,a=layui.jquery;t.render({elem:"#compnayList",url:"/manage/listcompany",id:"compnayList",cols:[[{type:"checkbox"},{field:"_id",width:80,title:"",sort:!1,templet:function(t){return t.LAY_INDEX}},{field:"logo",width:180,title:"图标",templet:function(t){var a='<button type="button" class="layui-btn layui-btn-sm layui-btn-radius btn-logo-upload"><i class="layui-icon">&#xe67c;</i>上传</button><input type="file" class="input-logo-upload" cpnid='+t._id+' style="display:none">';return t.logo?a+'<img src="'+t.logo+'">':a+"<img>"}},{field:"company",width:250,title:"公司"},{field:"alias",width:150,title:"別名",sort:!1,edit:"text"},{field:"addr",title:"地址",minWidth:250},{field:"city",width:80,title:"城市",sort:!1},{field:"district",width:90,title:"区域"},{field:"salary",width:90,title:"平均薪酬",edit:"text"},{field:"score",width:90,title:"评分",edit:"text"},{field:"description",width:90,title:"介绍",edit:"text"},{field:"bdStatus",width:92,title:"审核状态",templet:function(t){return t.bdStatus&&99==t.bdStatus?'<span class="layui-badge-rim" style="padding: 1px 5px 20px;">手动审核</span>':t.bdStatus&&77==t.bdStatus?'<span class="layui-badge-rim" style="padding: 1px 5px 20px;">回收站</span>':t.bdStatus&&3==t.bdStatus?'<span class="layui-badge-rim" style="padding: 1px 5px 20px;">地图识别</span>':t.bdStatus&&2==t.bdStatus?'<span class="layui-badge-rim" style="padding: 1px 5px 20px;">库识别</span>':t.bdStatus&&1==t.bdStatus?'<span class="layui-badge-rim" style="padding: 1px 5px 20px;">自动识别</span>':(t.bdStatus,'<span class="layui-badge-rim" style="padding: 1px 5px 20px;">未识别</span>')}},{fixed:"right",width:120,align:"center",toolbar:"#barCompany"}]],page:!0,done:l}),t.on("tool(company)",function(t){var e=t.data,i=t.event;if("detail"===i)layer.msg("查看暂不支持");else if("del"===i)layer.confirm("删除数据："+(e.alias||e.company)+"？",function(t){var i=layer.load(2);a.ajax({url:"/manage/deleteCompanyById",type:"post",data:{_id:e._id}}).done(function(t){if(layer.close(i),!!t&!!t.n&&t.n>0){layer.msg("删除成功！");try{layui.table.reload("compnayList")}catch(t){}}else layer.msg("删除失败，原因：未匹配的记录");a("#commitData").removeAttr("disabled")}).fail(function(t){layer.close(i),console.error(t),layer.msg("删除失败"),a("#commitData").removeAttr("disabled")})});else if("edit"===i)layer.msg("编辑操作");else if("position"===i){var n=layer.open({type:2,title:e.company+"-位置",maxmin:!1,offset:"100px",area:[a(window).width()+"px",a(window).height()+"px"],content:"/manage/pagecompanyposition?_id="+e._id});layer.full(n)}}),t.on("edit(company)",function(t){a.post("/manage/updateCompanyInfo",{id:t.data._id,field:t.field,value:t.value},o).fail(function(t){console.error(t),layer.msg("更新失败，网络错误")})});var e={setDelStatus:function(){var e=t.checkStatus("compnayList"),i=e.data;if(!i||i.length<=0)return void layer.alert("请选择至少一条记录");if(!r){r=!0;for(var n=i[0]._id,l=1;l<i.length;l++)n+=","+i[l]._id;var o=layer.load(2);a.ajax({url:"/manage/updateCompanyStatus",type:"post",data:{_ids:n,bdStatus:77}}).done(function(a){if(layer.close(o),!!a&!!a.n&&a.n>0){layer.msg("数据已提交");try{t.reload("compnayList")}catch(t){}}else layer.msg("提交数据执行失败，原因：未匹配的记录");r=!1}).fail(function(t){layer.close(o),console.error(t),layer.msg("操作失败"),r=!1})}}};a(".layui-form .layui-btn").on("click",function(){var t=a(this).data("type");e[t]&&e[t].call(this)})})}function l(){$(".btn-logo-upload").click(function(){$(this).next().click()}),$(".input-logo-upload").change(function(){var t=$(this),a=t[0].files[0],e=new FileReader;e.onload=function(){var a=e.result;$.post("/manage/updateCompanyInfo",{id:t.attr("cpnid"),field:"logo",value:a},function(e){o(e),t.next()[0].src=a}).fail(function(t){console.error(t),layer.msg("更新失败，网络错误")})},e.readAsDataURL(a)})}function o(t){!!t&!!t.n&&t.n>0?layer.msg("更新成功"):0===t.n?layer.msg("更新未执行"):layer.msg("更新执行失败")}$(function(){n(),$("#searchBtn").on("click",function(){var t=$("select[name=positionStatus]").val();layui.table.reload("compnayList",{where:{positionConfirm:t},page:{curr:1}})}),$("#searchBtnName").click(i),$("input[name=companyName]").on("keydown",function(t){"Enter"===t.key&&i()})});var r=!1},{}]},{},[1]);